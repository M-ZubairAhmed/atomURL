{"version":3,"sources":["App.js","index.js"],"names":["checkURLValidity","inputURL","urlRegex","RegExp","match","checkShortURLValidity","test","DestinationURLHolder","_ref","url","_ref$errors","errors","_ref$isCompleted","isCompleted","_ref$isWorking","isWorking","handleFormChange","react_default","a","createElement","className","name","type","concat","aria-label","aria-describedby","autoFocus","required","placeholder","title","disabled","onChange","e","value","DownArrow","ShortURLHolder","_ref2","_ref2$errors","_ref2$isCompleted","_ref2$isWorking","id","lib","text","Fragment","ActionButton","_ref3","_ref3$isWorking","_ref3$isCompleted","startNewForm","linkBothUrls","onClick","role","aria-hidden","App","state","longURLErrors","longURL","shortURLErrors","shortURL","_callee","_this$state","regenerator_default","wrap","_context","prev","next","preventDefault","_this","length","trim","slice","setState","checkAndShortURL","stop","_this$setState","validation","_e$target","target","Object","defineProperty","body","JSON","stringify","destinationURL","this","fetch","headers","Content-Type","method","mode","request","status","json","response","_context2","t0","error","console","_this$state2","App_DestinationURLHolder","App_DownArrow","App_ShortURLHolder","App_ActionButton","React","Component","ReactDOM","render","App_App","document","getElementById"],"mappings":"uRAGMA,EAAmB,SAACC,GACxB,IACIC,EAAW,IAAIC,OADM,uNAEzB,OAAQF,EAASG,MAAMF,IAGnBG,EAAwB,SAACJ,GAE7B,OADe,IAAIE,OAAO,aACTG,KAAKL,IAGlBM,EAAuB,SAAAC,GAMvB,IALJC,EAKID,EALJC,IAKIC,EAAAF,EAJJG,cAII,IAAAD,EAJK,GAILA,EAAAE,EAAAJ,EAHJK,mBAGI,IAAAD,KAAAE,EAAAN,EAFJO,iBAEI,IAAAD,KADJE,EACIR,EADJQ,iBAEA,OACEC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,mCACbH,EAAAC,EAAAC,cAAA,SACEE,KAAK,UACLC,KAAK,MACLF,UAAS,gBAAAG,OAA6B,KAAXZ,EAAgB,GAAK,aAAvC,KAAAY,OACPV,EAAc,yBAA2B,IAE3CW,aAAW,kBACXC,mBAAiB,8CACjBC,WAAW,EACXC,UAAU,EACVC,YAAY,kBACZC,MAAM,8CACNC,SAAUf,GAAaF,EACvBkB,SAAU,SAACC,GAAD,OAAOhB,EAAiBgB,IAClCC,MAAOxB,IAETQ,EAAAC,EAAAC,cAAA,OAAKC,UAAU,oBAAoBT,KAKnCuB,EAAY,kBAChBjB,EAAAC,EAAAC,cAAA,OAAKC,UAAU,eACbH,EAAAC,EAAAC,cAAA,KAAGC,UAAU,gCAIXe,EAAiB,SAAAC,GAMjB,IALJ3B,EAKI2B,EALJ3B,IAKI4B,EAAAD,EAJJzB,cAII,IAAA0B,EAJK,GAILA,EAAAC,EAAAF,EAHJvB,mBAGI,IAAAyB,KAAAC,EAAAH,EAFJrB,iBAEI,IAAAwB,KADJvB,EACIoB,EADJpB,iBAGA,OAAIH,EAEAI,EAAAC,EAAAC,cAAA,OAAKC,UAAU,wCACbH,EAAAC,EAAAC,cAAA,SACEqB,GAAG,gBACHlB,KAAK,OACLD,KAAK,WACLD,UAAS,sCACTI,aAAW,YACXC,mBAAiB,yBACjBE,UAAQ,EACRG,UAAQ,EACRG,MAAK,iBAAAV,OAAmBd,KAE1BQ,EAAAC,EAAAC,cAAA,OAAKC,UAAU,sBACbH,EAAAC,EAAAC,cAACsB,EAAA,gBAAD,CAAiBC,KAAI,iBAAAnB,OAAmBd,IACtCQ,EAAAC,EAAAC,cAAA,UACEC,UAAU,eACVE,KAAK,SACLkB,GAAG,gBACHX,MAAM,qBACNZ,EAAAC,EAAAC,cAAA,KAAGC,UAAU,oBAQrBH,EAAAC,EAAAC,cAAAF,EAAAC,EAAAyB,SAAA,KACE1B,EAAAC,EAAAC,cAAA,OAAKC,UAAU,8DAAf,iBAAAG,OAA8Fd,IAC9FQ,EAAAC,EAAAC,cAAA,OAAKC,UAAU,wCACbH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,yCACbH,EAAAC,EAAAC,cAAA,QAAMC,UAAU,mBAAmBoB,GAAG,wBAAtC,mBAIFvB,EAAAC,EAAAC,cAAA,SACEqB,GAAG,gBACHlB,KAAK,OACLD,KAAK,WACLD,UAAS,gBAAAG,OAA6B,KAAXZ,EAAgB,GAAK,cAChDa,aAAW,YACXC,mBAAiB,2CACjBI,MAAM,2CACNF,UAAQ,EACRC,YAAY,YACZE,SAAUf,EACVgB,SAAU,SAACC,GAAD,OAAOhB,EAAiBgB,IAClCC,MAAOxB,IAETQ,EAAAC,EAAAC,cAAA,OAAKC,UAAU,oBAAoBT,MAOvCiC,EAAe,SAAAC,GAKf,IAAAC,EAAAD,EAJJ9B,iBAII,IAAA+B,KAAAC,EAAAF,EAHJhC,mBAGI,IAAAkC,KAFJC,EAEIH,EAFJG,aACAC,EACIJ,EADJI,aAEA,OAAIpC,EAEAI,EAAAC,EAAAC,cAAA,OAAKC,UAAU,eACbH,EAAAC,EAAAC,cAAA,UACEG,KAAK,SACLF,UAAU,mCACV8B,QAAS,SAAClB,GAAD,OAAOgB,EAAahB,KAH/B,oCAUFf,EAAAC,EAAAC,cAAA,OAAKC,UAAU,eACbH,EAAAC,EAAAC,cAAA,UACEG,KAAK,SACLF,UAAU,sBACV8B,QAAS,SAAClB,GAAD,OAAOiB,EAAajB,IAC7BF,SAAUf,GACVE,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UACZL,EACG,0BACA,8BACJE,EAAAC,EAAAC,cAAA,QACEC,UAAS,sDAAAG,OACPR,EAAY,GAAK,UAEnBoC,KAAK,SACLC,cAAY,aASLC,6MACnBC,MAAQ,CACNC,cAAe,GACfC,QAAS,GACTC,eAAgB,GAChBC,SAAU,GACV3C,WAAW,EACXF,aAAa,KA0DfoC,mDAAe,SAAAU,EAAO3B,GAAP,IAAA4B,EAAAJ,EAAAE,EAAAH,EAAAE,EAAA,OAAAI,EAAA3C,EAAA4C,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OACbjC,EAAEkC,iBADWN,EAGiBO,EAAKb,MAA3BE,EAHKI,EAGLJ,QAASE,EAHJE,EAGIF,SAEbH,EAAgB,GAChBE,EAAiB,GAEjBzD,EAAiBwD,KACnBD,EAAgB,iDAEM,IAApBG,EAASU,OACXX,EAAiB,uBACRpD,EAAsBqD,GAC/BD,EACE,iEAE8B,MAAhCC,EAASW,OAAOC,MAAM,EAAG,IACK,MAA9BZ,EAASW,OAAOC,OAAO,KAEvBb,EAAiB,4CAIfF,GAAiBE,EACnBU,EAAKI,SAAS,CACZhB,gBACAE,mBAIFU,EAAKK,iBAAiBhB,EAASE,GA/BpB,wBAAAK,EAAAU,SAAAd,8DAmCfX,aAAe,SAAChB,GACdA,EAAEkC,iBACFC,EAAKI,SAAS,CACZxD,WAAW,EACXF,aAAa,EACb2C,QAAS,GACTE,SAAU,GACVH,cAAe,GACfE,eAAgB,QAIpBzC,iBAAmB,SAACgB,GAAM,IAAA0C,EACpBC,EAAa,GADOC,EAIpB5C,EADF6C,OAAUxD,EAHYuD,EAGZvD,KAAMY,EAHM2C,EAGN3C,MAGL,YAATZ,EACFsD,EAAa,gBACK,aAATtD,IACTsD,EAAa,kBAGfR,EAAKI,UAALG,EAAA,GAAAI,OAAAC,EAAA,EAAAD,CAAAJ,EACGrD,EAAOY,GADV6C,OAAAC,EAAA,EAAAD,CAAAJ,EAEGC,EAAa,IAFhBD,6HAlHqBlB,EAASE,wFACxBsB,EAAOC,KAAKC,UAAU,CAC1BC,eAAgB3B,EAAQa,OACxBX,SAAUA,EAASW,kBAGfe,KAAKb,SAAS,CAClBxD,WAAW,oCAIWsE,MAAM,WAAY,CACtCC,QAAS,CACPC,eAAgB,oBAElBC,OAAQ,OACRC,KAAM,OACNT,uBANIU,kBAQeA,EAAQC,qBAAvBA,mBACiBD,EAAQE,oBAAzBC,8BAGW,MAAXF,oCACIP,KAAKb,SAAS,CAClBxD,WAAW,EACXF,aAAa,yDAGJgF,GAAUF,gDAGjB,gFAGJlC,EAAiB,GAGjBA,EAFAqC,EAAAC,IAAOD,EAAAC,GAAIJ,OACM,MAAfG,EAAAC,GAAIJ,OACW,oDAEAG,EAAAC,GAAIC,MAIrB,wFAEEZ,KAAKb,SAAS,CAClBxD,WAAW,EACXF,aAAa,EACb4C,2BAEFwC,QAAQD,MAAM,uBAAdF,EAAAC,oJAqEK,IAAAG,EAaHd,KAXF9B,MACEzC,EAHGqF,EAGHrF,YACAE,EAJGmF,EAIHnF,UACAyC,EALG0C,EAKH1C,QACAD,EANG2C,EAMH3C,cACAG,EAPGwC,EAOHxC,SACAD,EARGyC,EAQHzC,eAEFzC,EAGEoE,KAHFpE,iBACAiC,EAEEmC,KAFFnC,aACAD,EACEoC,KADFpC,aAGF,OACE/B,EAAAC,EAAAC,cAAA,YACEF,EAAAC,EAAAC,cAAA,UAAQC,UAAU,cAAlB,WACAH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,kBACbH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,8BACbH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,gBACbH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,kDACbH,EAAAC,EAAAC,cAAA,YACEF,EAAAC,EAAAC,cAACgF,EAAD,CACE1F,IAAK+C,EACLxC,iBAAkBA,EAClBL,OAAQ4C,EACRxC,UAAWA,EACXF,YAAaA,IAEfI,EAAAC,EAAAC,cAACiF,EAAD,MACAnF,EAAAC,EAAAC,cAACkF,EAAD,CACE5F,IAAKiD,EACL1C,iBAAkBA,EAClBL,OAAQ8C,EACR1C,UAAWA,EACXF,YAAaA,IAEfI,EAAAC,EAAAC,cAACmF,EAAD,CACEzF,YAAaA,EACbE,UAAWA,EACXkC,aAAcA,EACdD,aAAcA,iBA5KDuD,IAAMC,WC1JvCC,IAASC,OAAOzF,EAAAC,EAAAC,cAACwF,EAAD,MAASC,SAASC,eAAe","file":"static/js/main.bfb75dc2.chunk.js","sourcesContent":["import React from 'react'\nimport { CopyToClipboard } from 'react-copy-to-clipboard'\n\nconst checkURLValidity = (inputURL) => {\n  var validURLExpression = /(https?:\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|https?:\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})/gi\n  var urlRegex = new RegExp(validURLExpression)\n  return !inputURL.match(urlRegex)\n}\n\nconst checkShortURLValidity = (inputURL) => {\n  var urlRegex = new RegExp('^[a-z-]+$')\n  return !urlRegex.test(inputURL)\n}\n\nconst DestinationURLHolder = ({\n  url,\n  errors = '',\n  isCompleted = false,\n  isWorking = false,\n  handleFormChange,\n}) => {\n  return (\n    <div className=\"input-group mb-3 input-group-lg\">\n      <input\n        name=\"longURL\"\n        type=\"url\"\n        className={`form-control ${errors === '' ? '' : 'is-invalid'} ${\n          isCompleted ? 'form-control-plaintext' : ''\n        }`}\n        aria-label=\"Destination url\"\n        aria-describedby=\"Enter the url which you want to redirect to\"\n        autoFocus={true}\n        required={true}\n        placeholder=\"destination url\"\n        title=\"Enter the url which you want to redirect to\"\n        disabled={isWorking || isCompleted}\n        onChange={(e) => handleFormChange(e)}\n        value={url}\n      />\n      <div className=\"invalid-feedback\">{errors}</div>\n    </div>\n  )\n}\n\nconst DownArrow = () => (\n  <div className=\"text-center\">\n    <i className=\"fas fa-arrow-down h3 my-2\" />\n  </div>\n)\n\nconst ShortURLHolder = ({\n  url,\n  errors = '',\n  isCompleted = false,\n  isWorking = false,\n  handleFormChange,\n}) => {\n  // Form page editing\n  if (isCompleted) {\n    return (\n      <div className=\"input-group input-group-lg mt-3 mb-5\">\n        <input\n          id=\"shortURLFinal\"\n          type=\"text\"\n          name=\"shortURL\"\n          className={`form-control form-control-plaintext`}\n          aria-label=\"Short url\"\n          aria-describedby=\"Short url you assigned\"\n          required\n          disabled\n          value={`atomurl.ga/go/${url}`}\n        />\n        <div className=\"input-group-append\">\n          <CopyToClipboard text={`atomurl.ga/go/${url}`}>\n            <button\n              className=\"btn btn-info\"\n              type=\"button\"\n              id=\"button-addon2\"\n              title=\"Copy to clipboard\">\n              <i className=\"far fa-copy\" />\n            </button>\n          </CopyToClipboard>\n        </div>\n      </div>\n    )\n  } else {\n    return (\n      <>\n        <div className=\"d-block d-md-none text-muted font-weight-light font-italic\">{`atomurl.ga/go/${url}`}</div>\n        <div className=\"input-group input-group-lg mt-3 mb-5\">\n          <div className=\"input-group-prepend d-none d-md-block\">\n            <span className=\"input-group-text\" id=\"inputGroup-sizing-lg\">\n              atomurl.ga/go/\n            </span>\n          </div>\n          <input\n            id=\"shortURLFinal\"\n            type=\"text\"\n            name=\"shortURL\"\n            className={`form-control ${errors === '' ? '' : 'is-invalid'}`}\n            aria-label=\"Short url\"\n            aria-describedby=\"Enter short url which you wish to assign\"\n            title=\"Enter short url which you wish to assign\"\n            required\n            placeholder=\"short url\"\n            disabled={isWorking}\n            onChange={(e) => handleFormChange(e)}\n            value={url}\n          />\n          <div className=\"invalid-feedback\">{errors}</div>\n        </div>\n      </>\n    )\n  }\n}\n\nconst ActionButton = ({\n  isWorking = false,\n  isCompleted = false,\n  startNewForm,\n  linkBothUrls,\n}) => {\n  if (isCompleted) {\n    return (\n      <div className=\"text-center\">\n        <button\n          type=\"button\"\n          className=\"btn btn-outline-info btn-lg mr-3\"\n          onClick={(e) => startNewForm(e)}>\n          Successfully linked, Add more ?\n        </button>\n      </div>\n    )\n  } else {\n    return (\n      <div className=\"text-center\">\n        <button\n          type=\"submit\"\n          className=\"btn btn-info btn-lg\"\n          onClick={(e) => linkBothUrls(e)}\n          disabled={isWorking}>\n          <div className=\"d-flex\">\n            {isWorking\n              ? 'Checking and adding url'\n              : 'Link both of the above urls'}\n            <span\n              className={`spinner-grow spinner-grow-md ml-3 fade animate-all ${\n                isWorking ? '' : 'd-none'\n              }`}\n              role=\"status\"\n              aria-hidden=\"true\"\n            />\n          </div>\n        </button>\n      </div>\n    )\n  }\n}\n\nexport default class App extends React.Component {\n  state = {\n    longURLErrors: '',\n    longURL: '',\n    shortURLErrors: '',\n    shortURL: '',\n    isWorking: false,\n    isCompleted: false,\n  }\n\n  async checkAndShortURL(longURL, shortURL) {\n    const body = JSON.stringify({\n      destinationURL: longURL.trim(),\n      shortURL: shortURL.trim(),\n    })\n\n    await this.setState({\n      isWorking: true,\n    })\n\n    try {\n      const request = await fetch('/api/add', {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        method: 'POST',\n        mode: 'cors',\n        body,\n      })\n      const status = await request.status\n      const response = await request.json()\n\n      if (response) {\n        if (status === 201) {\n          await this.setState({\n            isWorking: false,\n            isCompleted: true,\n          })\n        } else {\n          throw { ...response, status }\n        }\n      } else {\n        throw 'UNKNOW_ERROR'\n      }\n    } catch (err) {\n      let shortURLErrors = ''\n      if (err && err.status) {\n        if (err.status === 409) {\n          shortURLErrors = 'Short url already take, please try something else'\n        } else {\n          shortURLErrors = err.error\n        }\n      } else {\n        shortURLErrors =\n          'Something terrible happened while we tried linking the url, try again later'\n      }\n      await this.setState({\n        isWorking: false,\n        isCompleted: false,\n        shortURLErrors,\n      })\n      console.error('Error in linking url', err)\n    }\n  }\n\n  linkBothUrls = async (e) => {\n    e.preventDefault()\n\n    const { longURL, shortURL } = this.state\n\n    let longURLErrors = ''\n    let shortURLErrors = ''\n\n    if (checkURLValidity(longURL)) {\n      longURLErrors = 'URL should be of format <http>://domain.<tld>'\n    }\n    if (shortURL.length === 0) {\n      shortURLErrors = 'This cannot be empty'\n    } else if (checkShortURLValidity(shortURL)) {\n      shortURLErrors =\n        'Shortened url can only contain small letters and hyphens ( - )'\n    } else if (\n      shortURL.trim().slice(0, 1) === '-' ||\n      shortURL.trim().slice(-1) === '-'\n    ) {\n      shortURLErrors = 'It cannot start or end with hyphen ( - )'\n    }\n\n    // Settings state for errors\n    if (longURLErrors || shortURLErrors) {\n      this.setState({\n        longURLErrors,\n        shortURLErrors,\n      })\n    } else {\n      // Frontend no errors\n      this.checkAndShortURL(longURL, shortURL)\n    }\n  }\n\n  startNewForm = (e) => {\n    e.preventDefault()\n    this.setState({\n      isWorking: false,\n      isCompleted: false,\n      longURL: '',\n      shortURL: '',\n      longURLErrors: '',\n      shortURLErrors: '',\n    })\n  }\n\n  handleFormChange = (e) => {\n    let validation = ''\n    const {\n      target: { name, value },\n    } = e\n\n    if (name === 'longURL') {\n      validation = 'longURLErrors'\n    } else if (name === 'shortURL') {\n      validation = 'shortURLErrors'\n    }\n\n    this.setState({\n      [name]: value,\n      [validation]: '',\n    })\n  }\n\n  render() {\n    const {\n      state: {\n        isCompleted,\n        isWorking,\n        longURL,\n        longURLErrors,\n        shortURL,\n        shortURLErrors,\n      },\n      handleFormChange,\n      linkBothUrls,\n      startNewForm,\n    } = this\n\n    return (\n      <main>\n        <header className=\"App-header\">AtomURL</header>\n        <div className=\"container mt-5\">\n          <div className=\"row justify-content-center\">\n            <div className=\"col col-md-6\">\n              <div className=\"box-card shadow-lg rounded bg-white p-3 p-md-5\">\n                <form>\n                  <DestinationURLHolder\n                    url={longURL}\n                    handleFormChange={handleFormChange}\n                    errors={longURLErrors}\n                    isWorking={isWorking}\n                    isCompleted={isCompleted}\n                  />\n                  <DownArrow />\n                  <ShortURLHolder\n                    url={shortURL}\n                    handleFormChange={handleFormChange}\n                    errors={shortURLErrors}\n                    isWorking={isWorking}\n                    isCompleted={isCompleted}\n                  />\n                  <ActionButton\n                    isCompleted={isCompleted}\n                    isWorking={isWorking}\n                    linkBothUrls={linkBothUrls}\n                    startNewForm={startNewForm}\n                  />\n                </form>\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n    )\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}